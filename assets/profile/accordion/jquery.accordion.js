/*
Last Updated: 2016年6月10日 11:07:03

COTA
http://cota.jp
*/
(function(d,e,f){var a=e.event,c;a.special.smartresize={setup:function(){e(this).bind("resize",a.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",a.special.smartresize.handler)},handler:function(j,g){var i=this,h=arguments;j.type="smartresize";if(c){clearTimeout(c)}c=setTimeout(function(){jQuery.event.handle.apply(i,h)},g==="execAsap"?0:100)}};e.fn.smartresize=function(g){return g?this.bind("smartresize",g):this.trigger("smartresize",["execAsap"])};e.Accordion=function(g,h){this.$el=e(h);this.$items=this.$el.children("ul").children("li");this.itemsCount=this.$items.length;this._init(g)};e.Accordion.defaults={open:-1,oneOpenedItem:false,speed:600,easing:"easeInOutExpo",scrollSpeed:900,scrollEasing:"easeInOutExpo"};e.Accordion.prototype={_init:function(g){this.options=e.extend(true,{},e.Accordion.defaults,g);this._validate();this.current=this.options.open;this.$items.find("div.st-content").hide();this._saveDimValues();if(this.current!=-1){this._toggleItem(this.$items.eq(this.current))}this._initEvents()},_saveDimValues:function(){this.$items.each(function(){var g=e(this);g.data({originalHeight:g.find("a:first").height(),offsetTop:g.offset().top})})},_validate:function(){if(this.options.open<-1||this.options.open>this.itemsCount-1){this.options.open=-1}},_initEvents:function(){var g=this;this.$items.find("a:first").bind("click.accordion",function(i){var h=e(this).parent();if(g.options.oneOpenedItem&&g._isOpened()&&g.current!==h.index()){g._toggleItem(g.$items.eq(g.current))}g._toggleItem(h);return false});e(d).bind("smartresize.accordion",function(h){g._saveDimValues();g.$el.find("li.st-open").each(function(){var i=e(this);i.css("height",i.data("originalHeight")+i.find("div.st-content").outerHeight(true))});if(g._isOpened()){g._scroll()}})},_isOpened:function(){return(this.$el.find("li.st-open").length>0)},_toggleItem:function(g){var h=g.find("div.st-content");(g.hasClass("st-open"))?(this.current=-1,h.stop(true,true).fadeOut(this.options.speed),g.removeClass("st-open").stop().animate({height:g.data("originalHeight")},this.options.speed,this.options.easing)):(this.current=g.index(),h.stop(true,true).fadeIn(this.options.speed),g.addClass("st-open").stop().animate({height:g.data("originalHeight")+h.outerHeight(true)},this.options.speed,this.options.easing),this._scroll(this))},_scroll:function(g){var g=g||this,h;(g.current!==-1)?h=g.current:h=g.$el.find("li.st-open:last").index();e("html, body").stop().animate({scrollTop:(g.options.oneOpenedItem)?g.$items.eq(h).data("offsetTop"):g.$items.eq(h).offset().top},g.options.scrollSpeed,g.options.scrollEasing)}};var b=function(g){if(this.console){console.error(g)}};e.fn.accordion=function(h){if(typeof h==="string"){var g=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"accordion");if(!i){b("cannot call methods on accordion prior to initialization; attempted to call method '"+h+"'");return}if(!e.isFunction(i[h])||h.charAt(0)==="_"){b("no such method '"+h+"' for accordion instance");return}i[h].apply(i,g)})}else{this.each(function(){var i=e.data(this,"accordion");if(!i){e.data(this,"accordion",new e.Accordion(h,this))}})}return this}})(window,jQuery);